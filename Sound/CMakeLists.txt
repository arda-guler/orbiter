if(ORBITER_BUILD_XRSOUND)

file(TO_NATIVE_PATH "${ORBITER_BINARY_ROOT_DIR}" ORBITER_BINARY_ROOT_DIR_W)
file(TO_NATIVE_PATH "${IRRKLANG_DIR}" IRRKLANG_DIR_W)


ExternalProject_Add(XRSound
	PREFIX ${CMAKE_CURRENT_BINARY_DIR}/XRSound
	BINARY_DIR ${CMAKE_CURRENT_BINARY_DIR}/XRSound
	SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/XRSound
	INSTALL_DIR ${ORBITER_INSTALL_ROOT_DIR}/Sound/XRSound
	CONFIGURE_COMMAND ""
	BUILD_COMMAND ${CMAKE_COMMAND} -E env ORBITER_ROOT=${ORBITER_BINARY_ROOT_DIR_W};ORBITER_ROOT_X64=${ORBITER_BINARY_ROOT_DIR_W};IRRKLANG_ROOT=${IRRKLANG_DIR_W};IRRKLANG_ROOT_X64=${IRRKLANG_DIR_W} msbuild ${CMAKE_CURRENT_SOURCE_DIR}/XRSound/XRSound/src/XRSound.sln /p:Platform=${ARCH} /p:Configuration=Release
	INSTALL_COMMAND ""
)

# Make sure Orbiter.lib is available
ExternalProject_Add_StepDependencies(XRSound build ${OrbiterTgt} Orbitersdk)

endif()
